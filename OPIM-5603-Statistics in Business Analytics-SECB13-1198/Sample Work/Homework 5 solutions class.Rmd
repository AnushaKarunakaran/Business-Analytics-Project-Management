---
title: "HW 5 Solutions"
output: html_notebook
---

# Problem 1

## Problem 1a

Let N be the number of customers that arrive in the first 10 minutes that the store is open.

N can be modeled as a Poisson random variable, with lambda = 4 (1/2.5*10)

The problem asks for P(N < 6) = P(N <= 5)

```{r}
ppois(5,lambda = 4)
```

## Problem 1b

Let X be the number of scoops a randomly chosen customers orders.
Let Y be the number of additional scoops over the first one that a randomly chosen customers orders. 

X = 1 + Y, where Y is a binomial random variables, with n = 2, pi = 0.5

The PMF is:

X = 1 w.p. dbinom(0,2,0.5)
X = 2 w.p. dbinom(1,2,0.5)
X = 3 w.p. dbinom(2,2,0.5)

```{r}
dbinom(0,2,0.5)
dbinom(1,2,0.5)
dbinom(2,2,0.5)
```

## Problem 1c

We have to simulate, becuase this involves multiplying random variables

First, let's simulate one customers number of scoops
```{r}
1 + rbinom(1,2,0.5)
```

Now, let's simulate the number of times a customer comes in

Let H be the number of customers that come in during the first hour

This will be a Poisson random variable with lambda = 60*1/2.5 

```{r}
rpois(1,60/2.5)
```

So, if we wanted to simulate the number of scoops purchased by the set of customers that come in during one hour, it would be

```{r}
1 + rbinom(rpois(1,60/2.5),2,0.5) 
```

To find the sum of the number of scoops:

```{r}
sum(1 + rbinom(rpois(1,60/2.5),2,0.5) )
```

Now, replicate many times and find the mean!

```{r}
mean( replicate( 10000 , sum(1 + rbinom(rpois(1,60/2.5),2,0.5) ) ) )
```
#Problem 2
Let C be a random variable for the number of cars arriving per minute
Let T be a random variable for the number of trucks arriving per minute

```{r}
lambda_C<-3
lambda_T<-1.5
```

##Problem 2a
To find: E(C for 10 minutes)
```{r}
10*lambda_C
```

##Problem 2b
To find: P(T=0)
```{r}
dpois(0,lambda = lambda_T)
```

## Problem 2c
We have to simulate to find the standard deviation. The number of vehicles (cars + trucks) arriving in 20 minutes can be simulated as follows:
```{r}
rpois(1,lambda = 20*lambda_C) + rpois(1,lambda = 20*lambda_T)
```

The standard deviation is calculated as follows
```{r}
sd(replicate(10000,rpois(1,lambda = 20*lambda_C) + rpois(1,lambda = 20*lambda_T)))
```

## Problem 2d
Let R be the random variable for the revenue generated by the toll plaza.

We need to simulate because we do not know the distribution of revenue. The revenue can be simulated as follows:
```{r}
rpois(1,lambda = 60*lambda_C)*3 + rpois(1,lambda = 60*lambda_T)*6.5
```

Replicate many times to generate a distribution for revenue. The question asks for P(R>1000).
That can counted from the distribution that we generated
```{r}
revenue <- replicate(1000,rpois(1,lambda = 60*lambda_C)*3 + rpois(1,lambda = 60*lambda_T)*6.5)
sum(revenue>1000)/length(revenue)
```

# Problem 3
```{r}
mu <- 5
```

## Problem 3a
Let L be the random variable for the lifetime of a light bulb (amount of time before the bulb stops working)

We know that L is exponentially distributed with mean (mu) = 5

Now, the question asks for P(L>7) = 1 - P(L<=7)
```{r}
1 - pexp(q = 7,rate = (1/mu))
```

## Problem 3b
To  find: P(L>4) = 1 - P(L<=4)
```{r}
1 - pexp(4,(1/mu))
```

## Problem 3c
To find: P(L>10|L>6) 
         = P(L>10 and L>6)/P(L>6)
         = P(L>10)/P(L>6)

```{r}
(1 - pexp(10,(1/mu)))/(1 - pexp(6,(1/mu)))
```

## Problem 3d
To find: P(L>14|L>10) 
         = P(L>14 and L>10)/P(L>10)
         = P(L>14)/P(L>10)

```{r}
(1 - pexp(14,(1/mu)))/(1 - pexp(10,(1/mu)))
```

## Problem 3e
We see that the probability of the light bulb lasting 4 years is the same irrespective of how many years it has lasted already. This is true for any value instead of 4 as well! This is called the memoryless property of the exponential distribution where the amount of time already elapsed does not matter.
